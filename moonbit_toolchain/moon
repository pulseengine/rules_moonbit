#!/bin/bash
# MoonBit compiler placeholder for testing
echo "MoonBit compiler placeholder - version 0.6.33"
echo "This is a test toolchain, not the real MoonBit compiler"
echo "Command: $@"

# For build commands, create a dummy output file
if [[ "$1" == "build" ]]; then
    shift
    OUTPUT_FILE=""
    SOURCES=()
    
    # Parse arguments
    while [[ $# -gt 0 ]]; do
        case "$1" in
            --output)
                OUTPUT_FILE="$2"
                shift 2
                ;;
            --target)
                TARGET="$2"
                shift 2
                ;;
            *)
                if [[ "$1" == -* ]]; then
                    shift
                else
                    SOURCES+=("$1")
                    shift
                fi
                ;;
        esac
    done
    
    # Create a dummy output file
    if [[ -n "$OUTPUT_FILE" ]]; then
        echo "// MoonBit compiled output (test)" > "$OUTPUT_FILE"
        echo "// Sources: ${SOURCES[*]}" >> "$OUTPUT_FILE"
        echo "// Target: ${TARGET:-native}" >> "$OUTPUT_FILE"
        echo "// This is a test file generated by the placeholder compiler" >> "$OUTPUT_FILE"
        echo "" >> "$OUTPUT_FILE"
        
        # Make it look like a real compiled file
        for src in "${SOURCES[@]}"; do
            echo "// Included: $src" >> "$OUTPUT_FILE"
        done
        
        echo "MoonBit test compilation successful: $OUTPUT_FILE"
        exit 0
    fi
fi

# For other commands
if [[ "$1" == "test" ]]; then
    echo "MoonBit test execution successful"
    exit 0
fi

echo "MoonBit placeholder completed successfully"
